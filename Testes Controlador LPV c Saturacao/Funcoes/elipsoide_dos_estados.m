clear
clc
%%
load('larissa_tarsis_LPV_saturacao_perturbacao_degrau_unitario_2.mat')
%%
sp_h3 = 0.28;
sp_h4 = 0.3813;
x = [(h4*1e-2-sp_h4);(h3*1e-2-sp_h3);x_i];
plot_dir3(x(1,:)',x(2,:)',x(3,:)','r')
title('Trajet√≥ria dos Estados')
xlabel('h_{4}')
ylabel('h_{3}')
zlabel('x_{i}')
grid on
hold on
%% 
% Lambda de contrativa = 0.764
P1 = [2236.06445774520 4463.25769072889 -727.042469880451;4463.25769072889 13144.7120080504 -2077.72659979812;-727.042469880451 -2077.72659979812 369.617745322077];
P2 = [2354.33516811486 4512.34722588798 -745.726171005591;4512.34722588798 12342.1126370933 -1991.32707793221;-745.726171005591 -1991.32707793221 362.257249440359]; 
k = sdpvar(3,1);
plot(k'*P1*k <=1 & k'*P2*k <=1)
%% 
% Sem lambda de contratividade
P3 = [0.000170845829690850	-7.86978452938101e-05	-2.15202919629836e-07;-7.86978452938101e-05	0.000131519782852506	-1.26108111556219e-07;-2.15202919629836e-07	-1.26108111556219e-07	2.74616496641700e-09];
P4 = [0.000170896369626634	-7.86945073348142e-05	-2.19225737177383e-07;-7.86945073348142e-05	0.000131445873886569	-1.21716045595194e-07;-2.19225737177383e-07	-1.21716045595194e-07	2.74613063371820e-09];
j = sdpvar(3,1);
plot(j'*P3*j <=1 & j'*P4*j <=1)
%%
% Lambda de contratividade = 0.9 rho=0.25
P5 = [232.8389  215.7378  -21.1264; 215.7378  319.4255  -29.7730;-21.1264  -29.7730    3.3402];
P6 = [241.2974  213.4019  -21.5287; 213.4019  302.6264  -28.6577;-21.5287  -28.6577    3.3015];
s = sdpvar(3,1);
plot(s'*P5*s <=1 & s'*P6*s <=1)
%%
% Lambda de contratividade = 0.8 rho=0.15
P7 = []